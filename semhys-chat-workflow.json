{
  "meta": {
    "instanceId": "semhys-chat-agent"
  },
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "semhys-chat",
        "responseMode": "responseNode"
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [240, 300],
      "id": "webhook-chat-receiver",
      "name": "Chat Webhook",
      "webhookId": "semhys-chat-webhook"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.category}}",
              "operation": "equal",
              "value2": "technical"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [460, 300],
      "id": "category-classifier",
      "name": "¬øEs Consulta T√©cnica?"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.priority}}",
              "operation": "equal",
              "value2": "high"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [680, 180],
      "id": "priority-check",
      "name": "¬øEs Urgente?"
    },
    {
      "parameters": {
        "authentication": "generic",
        "generic": {
          "auth": {
            "username": "contact@semhys.com",
            "password": "Q@bola400"
          }
        },
        "fromEmail": "contact@semhys.com",
        "toEmail": "contact@semhys.com",
        "subject": "üö® CONSULTA T√âCNICA URGENTE - SEMHYS Chat",
        "text": "=CONSULTA T√âCNICA URGENTE\n\nüë§ Sesi√≥n: {{$json.sessionId}}\nüïí Hora: {{$json.timestamp}}\nüì± Idioma: {{$json.language}}\nüî• Prioridad: {{$json.priority}}\n\nüí¨ MENSAJE:\n{{$json.message}}\n\nü§ñ Clasificaci√≥n IA:\n- Categor√≠a: {{$json.category}}\n- Confianza: {{Math.round($json.confidence * 100)}}%\n\n‚ö° Esta consulta requiere atenci√≥n t√©cnica especializada inmediata.",
        "options": {
          "allowUnauthorizedCerts": false
        },
        "transporterOptions": {
          "host": "smtp.hostinger.com",
          "port": 587,
          "secure": false
        }
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2,
      "position": [900, 100],
      "id": "urgent-email-alert",
      "name": "Alerta Email Urgente"
    },
    {
      "parameters": {
        "authentication": "generic",
        "generic": {
          "auth": {
            "username": "contact@semhys.com",
            "password": "Q@bola400"
          }
        },
        "fromEmail": "contact@semhys.com",
        "toEmail": "contact@semhys.com",
        "subject": "üîß Nueva Consulta T√©cnica - SEMHYS Chat",
        "text": "=NUEVA CONSULTA T√âCNICA\n\nüë§ Sesi√≥n: {{$json.sessionId}}\nüïí Hora: {{$json.timestamp}}\nüì± Idioma: {{$json.language}}\n‚ö° Prioridad: {{$json.priority}}\n\nüí¨ MENSAJE:\n{{$json.message}}\n\nü§ñ An√°lisis IA:\n- Categor√≠a: T√©cnica\n- Confianza: {{Math.round($json.confidence * 100)}}%\n\nüîß Se requiere respuesta de equipo de ingenier√≠a.",
        "options": {
          "allowUnauthorizedCerts": false
        },
        "transporterOptions": {
          "host": "smtp.hostinger.com",
          "port": 587,
          "secure": false
        }
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2,
      "position": [900, 260],
      "id": "technical-email",
      "name": "Email Consulta T√©cnica"
    },
    {
      "parameters": {
        "authentication": "generic",
        "generic": {
          "auth": {
            "username": "contact@semhys.com",
            "password": "Q@bola400"
          }
        },
        "fromEmail": "contact@semhys.com",
        "toEmail": "contact@semhys.com",
        "subject": "üí¨ Nueva Consulta General - SEMHYS Chat",
        "text": "=NUEVA CONSULTA GENERAL\n\nüë§ Sesi√≥n: {{$json.sessionId}}\nüïí Hora: {{$json.timestamp}}\nüì± Idioma: {{$json.language}}\n\nüí¨ MENSAJE:\n{{$json.message}}\n\nü§ñ An√°lisis IA:\n- Categor√≠a: General\n- Confianza: {{Math.round($json.confidence * 100)}}%\n\n‚ÑπÔ∏è Consulta de informaci√≥n general o comercial.",
        "options": {
          "allowUnauthorizedCerts": false
        },
        "transporterOptions": {
          "host": "smtp.hostinger.com",
          "port": 587,
          "secure": false
        }
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2,
      "position": [680, 420],
      "id": "general-email",
      "name": "Email Consulta General"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"customResponse\": \"Gracias por tu consulta t√©cnica. Nuestro equipo de ingenier√≠a la revisar√° y te contactar√° a la brevedad con una soluci√≥n especializada.\",\n  \"category\": \"{{$json.category}}\",\n  \"priority\": \"{{$json.priority}}\",\n  \"processed\": true\n}"
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [1120, 180],
      "id": "technical-response",
      "name": "Respuesta T√©cnica"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"customResponse\": \"¬°Gracias por contactarnos! Hemos recibido tu consulta y te responderemos pronto. Para informaci√≥n inmediata, puedes explorar nuestros servicios en la web.\",\n  \"category\": \"{{$json.category}}\",\n  \"priority\": \"{{$json.priority}}\",\n  \"processed\": true\n}"
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [900, 420],
      "id": "general-response",
      "name": "Respuesta General"
    }
  ],
  "connections": {
    "Chat Webhook": {
      "main": [
        [
          {
            "node": "¬øEs Consulta T√©cnica?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "¬øEs Consulta T√©cnica?": {
      "main": [
        [
          {
            "node": "¬øEs Urgente?",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Email Consulta General",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "¬øEs Urgente?": {
      "main": [
        [
          {
            "node": "Alerta Email Urgente",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Email Consulta T√©cnica",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Alerta Email Urgente": {
      "main": [
        [
          {
            "node": "Respuesta T√©cnica",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Email Consulta T√©cnica": {
      "main": [
        [
          {
            "node": "Respuesta T√©cnica",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Email Consulta General": {
      "main": [
        [
          {
            "node": "Respuesta General",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2024-01-01T00:00:00.000Z",
      "updatedAt": "2024-01-01T00:00:00.000Z",
      "id": "semhys-chat",
      "name": "SEMHYS Chat Agent"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2024-01-01T00:00:00.000Z",
  "versionId": "semhys-chat-v1"
}